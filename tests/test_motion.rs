use binrw::BinRead;
use std::{error::Error, io::Cursor};

use f1_2021_rust::{Packet, Body};

static MOTION_DATA_EXAMPLE: &[u8] = &[
    229, 7, 1, 5, 1, 0, 187, 134, 38, 178, 108, 178, 251, 17, 160, 1, 214, 67, 255, 32, 0, 0, 19,
    255, 12, 20, 22, 68, 3, 11, 34, 192, 34, 35, 54, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156,
    96, 255, 254, 12, 172, 244, 83, 28, 0, 157, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 81,
    18, 64, 193, 7, 176, 59, 147, 199, 99, 186, 43, 53, 142, 67, 219, 250, 90, 65, 228, 237, 35,
    195, 76, 207, 128, 194, 155, 208, 172, 63, 173, 152, 138, 192, 70, 128, 196, 2, 44, 248, 232,
    7, 186, 3, 78, 128, 216, 223, 14, 64, 40, 228, 240, 62, 176, 189, 75, 190, 233, 249, 208, 191,
    3, 6, 162, 60, 118, 199, 238, 188, 164, 125, 29, 68, 128, 36, 120, 192, 147, 26, 58, 193, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 78, 96, 0, 0, 177, 171, 79, 84, 0, 0, 78, 96, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 68, 141, 18, 64, 198, 200, 157, 175, 1, 0, 128, 35, 82, 118, 13, 68, 68, 149,
    162, 191, 213, 193, 169, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 95, 255, 254, 88, 171,
    169, 84, 228, 255, 255, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 201, 18, 64, 147, 75, 212,
    59, 136, 199, 99, 58, 224, 161, 16, 68, 66, 128, 231, 191, 0, 162, 140, 194, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 254, 95, 255, 254, 88, 171, 169, 84, 228, 255, 255, 95, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 129, 201, 18, 64, 147, 75, 212, 59, 136, 199, 99, 58, 90, 144, 36, 68, 0, 193,
    41, 193, 55, 120, 146, 67, 193, 240, 14, 194, 159, 17, 2, 64, 78, 8, 180, 193, 44, 148, 42, 6,
    81, 187, 198, 68, 64, 0, 14, 148, 30, 157, 255, 191, 144, 35, 25, 61, 144, 203, 188, 189, 60,
    222, 8, 192, 127, 36, 34, 61, 14, 23, 1, 187, 175, 214, 17, 68, 170, 161, 231, 191, 25, 156,
    129, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 140, 96, 225, 254, 250, 171, 6, 84, 0, 0, 141,
    96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 148, 93, 18, 64, 99, 248, 216, 59, 254, 253, 87, 183,
    58, 223, 20, 68, 3, 11, 34, 192, 104, 47, 76, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 95,
    255, 254, 88, 171, 169, 84, 228, 255, 255, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 201,
    18, 64, 147, 75, 212, 59, 136, 199, 99, 58, 140, 66, 25, 68, 226, 129, 68, 192, 183, 187, 247,
    193, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156, 96, 255, 254, 12, 172, 244, 83, 28, 0, 157, 96,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 81, 18, 64, 193, 7, 176, 59, 147, 199, 99, 186, 204,
    18, 6, 68, 157, 243, 154, 188, 172, 160, 237, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 95,
    255, 254, 88, 171, 169, 84, 228, 255, 255, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 201,
    18, 64, 147, 75, 212, 59, 136, 199, 99, 58, 96, 237, 2, 68, 166, 200, 7, 63, 36, 249, 4, 195,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 95, 255, 254, 88, 171, 169, 84, 228, 255, 255, 95, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 201, 18, 64, 147, 75, 212, 59, 136, 199, 99, 58, 153,
    116, 10, 68, 225, 215, 14, 191, 96, 119, 197, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156, 96,
    255, 254, 12, 172, 244, 83, 28, 0, 157, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 81, 18,
    64, 193, 7, 176, 59, 147, 199, 99, 186, 186, 13, 24, 68, 226, 129, 68, 192, 23, 234, 17, 194,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 95, 255, 254, 88, 171, 169, 84, 228, 255, 255, 95, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 201, 18, 64, 147, 75, 212, 59, 136, 199, 99, 58, 34, 171,
    14, 68, 68, 149, 162, 191, 211, 187, 158, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156, 96,
    255, 254, 12, 172, 244, 83, 28, 0, 157, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 81, 18,
    64, 193, 7, 176, 59, 147, 199, 99, 186, 146, 222, 36, 68, 154, 2, 162, 192, 70, 232, 177, 65,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156, 96, 255, 254, 12, 172, 244, 83, 28, 0, 157, 96, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 81, 18, 64, 193, 7, 176, 59, 147, 199, 99, 186, 144, 113,
    31, 68, 20, 101, 138, 192, 235, 85, 41, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 95, 255,
    254, 88, 171, 169, 84, 228, 255, 255, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 201, 18, 64,
    147, 75, 212, 59, 136, 199, 99, 58, 208, 72, 28, 68, 40, 122, 114, 192, 31, 34, 137, 193, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 35, 96, 33, 255, 129, 171, 127, 84, 160, 255, 36, 96, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 102, 173, 18, 64, 58, 179, 231, 59, 94, 111, 64, 59, 199, 169, 35, 68,
    20, 11, 162, 192, 252, 207, 133, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 96, 225, 254, 106,
    171, 151, 84, 0, 0, 15, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 148, 189, 18, 64, 29, 106, 216,
    59, 3, 1, 88, 55, 197, 2, 210, 67, 55, 231, 197, 63, 63, 111, 199, 66, 144, 116, 197, 193, 183,
    77, 5, 191, 134, 38, 0, 194, 57, 178, 77, 254, 93, 154, 164, 101, 211, 252, 70, 178, 106, 215,
    0, 192, 0, 246, 223, 60, 236, 170, 64, 188, 0, 66, 31, 192, 179, 193, 62, 60, 85, 121, 203, 60,
    45, 34, 4, 68, 166, 200, 7, 63, 93, 236, 254, 194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 156, 96,
    255, 254, 12, 172, 244, 83, 28, 0, 157, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 81, 18,
    64, 193, 7, 176, 59, 147, 199, 99, 186, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 184, 219, 137, 193, 187, 219, 137, 193, 192, 64, 208, 192, 202, 64, 208, 192,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 128,
];

#[test]
fn test_motion() -> Result<(), Box<dyn Error>> {
    let pkt = Packet::read(&mut Cursor::new(MOTION_DATA_EXAMPLE))?;

    assert!(matches!(pkt.body, Body::Motion(_)));

    Ok(())
}
